let A = 
(* main[0, <top of main>] *)
assume Defined(Ztp(argv0)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv1)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv2)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv3)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv4)) in
in(c, var1);
assume Defined(var1) in
(* assume_len[9, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var1) = 112 in
let BIO_new_connect_result1 = var1 (* named BIO_new_connect_result1 *) in
in(c, var2);
assume Defined(var2) in
(* assume_len[13, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var2) = 8 in
let BIO_ctrl_result1 = var2 (* named BIO_ctrl_result1 *) in
(* socket_connect[4, // net.c:50] *)
if ¬((BIO_ctrl_result1)_[s,8] <= 0) then 
(* assume_intype[19, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(hostA) in
(* assume_intype[20, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(hostA) >= 0) /\ (len(hostA) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_host_proxy[15, // lib_proxy.c:225] *)
if ¬(len(hostA) > 40) then 
(* assume_intype[25, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(hostX) in
(* assume_intype[26, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(hostX) >= 0) /\ (len(hostX) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_xhost_proxy[21, // lib_proxy.c:243] *)
if ¬(len(hostX) > 40) then 
(* assume_intype[31, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(pkA) in
(* assume_intype[32, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(pkA) >= 0) /\ (len(pkA) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_pkey_proxy[27, // lib_proxy.c:143] *)
if ¬(len(pkA) > 100) then 
(* assume_intype[37, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(skA) in
(* assume_intype[38, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(skA) >= 0) /\ (len(skA) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_skey_proxy[33, // lib_proxy.c:167] *)
if ¬(len(skA) > 100) then 
(* assume_intype[44, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(pkX) in
(* assume_intype[45, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(pkX) >= 0) /\ (len(pkX) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_xkey_proxy[40, // lib_proxy.c:189] *)
if ¬(len(pkX) > 100) then 
(* assume_intype[50, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(sigX) in
(* assume_intype[51, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(sigX) >= 0) /\ (len(sigX) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* assume_intype[56, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(pkS) in
(* assume_intype[57, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(pkS) >= 0) /\ (len(pkS) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
let host1 = hostX (* named host1 *) in
let key1 = pkX (* named key1 *) in
let sig1 = sigX (* named sig1 *) in
let sigkey1 = pkS (* named sigkey1 *) in
(* assume_len[63, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume 1 = 1 in
(* lookup_xkey[39, // keys.c:20] *)
if check_key(host1, key1, sig1, sigkey1) then 
event client_begin(hostA, hostX);
new var3: fixed_20_nonce;
let nonce1 = var3 (* named nonce1 *) in
let msg1 = "msg1"|(20)^[u,8]|nonce1|hostA (* named msg1 *) in
let key2 = pkX (* named key2 *) in
let key3 = isek(key2) (* named key3 *) in
new var4: fixed_256_seed_T;
let nonce2 = var4 (* named nonce2 *) in
let cipher1 = E(msg1, key3, nonce2) (* named cipher1 *) in
(* assume_intype[88, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(cipher1) >= 0) /\ (len(cipher1) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* encrypt_proxy[83, // lib_proxy.c:65] *)
if ¬(len(cipher1) > (7 + 24 + len(hostA) + 8)) then 
let msg2 = (len(cipher1))^[u,8] (* named msg2 *) in
out(c, msg2);
(* send[95, // net.c:66] *)
if 0 < len(cipher1) then 
let msg3 = cipher1 (* named msg3 *) in
out(c, msg3);
in(c, var5);
assume Defined(var5) in
(* assume_len[102, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var5) = 8 in
let msg4 = var5 (* named msg4 *) in
(* main[1, // client.c:124] *)
if ¬((msg4)_[u,8] > 1000) then 
(* recv[106, // net.c:88] *)
if 0 < (msg4)_[u,8] then 
in(c, var6);
assume Defined(var6) in
(* assume_len[109, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var6) = (msg4)_[u,8] in
let msg5 = var6 (* named msg5 *) in
(* decrypt_len[111, // lib.c:53] *)
if ¬((msg4)_[u,8] < 7) then 
let cipher2 = msg5 (* named cipher2 *) in
let key4 = skA (* named key4 *) in
let msg6 = inverse_injbot(D(cipher2, key4)) (* named msg6 *) in
(* assume_intype[118, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(msg6) >= 0) /\ (len(msg6) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* decrypt_proxy[114, // lib_proxy.c:110] *)
if ¬(len(msg6) > ((msg4)_[u,8] - 7)) then 
(* main[1, // client.c:137] *)
if ¬((len(hostX) + 40 + (2 * 8) + 4) <> len(msg6)) then 
(* assume_intype[124, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume ((len(msg6) >= 4) /\ (0 >= 0) /\ (4 >= 0)) /\ True() in
(* assume_len[125, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(Cmp(msg6{0, 4}, "msg2")) = 4 in
(* main[1, // client.c:144] *)
if msg6{0, 4} = "msg2" then 
(* main[1, // client.c:153] *)
if ¬((msg6{4, 8})_[u,8] <> 20) then 
(* main[1, // client.c:159] *)
if ¬((msg6{4 + 8, 8})_[u,8] <> 20) then 
(* assume_intype[132, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume ((len(msg6) >= (4 + (2 * 8) + 20)) /\ ((4 + (2 * 8)) >= 0) /\ (20 >= 0)) /\ Defined(nonce1) in
(* assume_len[133, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(Cmp(msg6{4 + (2 * 8), 20}:fixed_20_nonce, nonce1)) = 4 in
(* main[1, // client.c:168] *)
ifeq msg6{4 + (2 * 8), 20}:fixed_20_nonce = nonce1 then 
(* assume_intype[140, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume ((len(msg6) >= len(msg6)) /\ (((msg6{4, 8})_[u,8] + (msg6{4 + 8, 8})_[u,8] + (2 * 8) + 4) >= 0) /\ ((len(msg6) - ((msg6{4, 8})_[u,8] + (msg6{4 + 8, 8})_[u,8] + (2 * 8) + 4)) >= 0)) /\ Defined(hostX) in
(* assume_len[141, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(Cmp(msg6{(msg6{4, 8})_[u,8] + (msg6{4 + 8, 8})_[u,8] + (2 * 8) + 4, len(msg6) - ((msg6{4, 8})_[u,8] + (msg6{4 + 8, 8})_[u,8] + (2 * 8) + 4)}:bounded_40_host, hostX)) = 4 in
(* main[1, // client.c:180] *)
ifeq msg6{(msg6{4, 8})_[u,8] + (msg6{4 + 8, 8})_[u,8] + (2 * 8) + 4, len(msg6) - ((msg6{4, 8})_[u,8] + (msg6{4 + 8, 8})_[u,8] + (2 * 8) + 4)}:bounded_40_host = hostX then 
let msg7 = "msg3"|msg6{4 + (2 * 8) + 20, ((msg6{4, 8})_[u,8] + (msg6{4 + 8, 8})_[u,8]) - 20}:fixed_20_nonce (* named msg7 *) in
let key5 = pkX (* named key5 *) in
let key6 = isek(key5) (* named key6 *) in
new var7: fixed_256_seed_T;
let nonce3 = var7 (* named nonce3 *) in
let cipher3 = E(msg7, key6, nonce3) (* named cipher3 *) in
(* assume_intype[161, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(cipher3) >= 0) /\ (len(cipher3) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* encrypt_proxy[156, // lib_proxy.c:65] *)
if ¬(len(cipher3) > (7 + 4 + (msg6{4 + 8, 8})_[u,8])) then 
let msg8 = (len(cipher3))^[u,8] (* named msg8 *) in
out(c, msg8);
(* send[168, // net.c:66] *)
if 0 < len(cipher3) then 
let msg9 = cipher3 (* named msg9 *) in
out(c, msg9);
event client_end(hostA, hostX);

let B = 
(* main[0, <top of main>] *)
assume Defined(Ztp(argv0)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv1)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv2)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv3)) in
(* main[0, <top of main>] *)
assume Defined(Ztp(argv4)) in
in(c, var8);
assume Defined(var8) in
(* assume_len[9, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var8) = 112 in
let BIO_new_accept_result1 = var8 (* named BIO_new_accept_result1 *) in
in(c, var9);
assume Defined(var9) in
(* assume_len[13, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var9) = 8 in
let BIO_ctrl_result2 = var9 (* named BIO_ctrl_result2 *) in
(* socket_listen[4, // net.c:21] *)
if ¬((BIO_ctrl_result2)_[s,8] <= 0) then 
in(c, var10);
assume Defined(var10) in
(* assume_len[17, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var10) = 8 in
let BIO_ctrl_result3 = var10 (* named BIO_ctrl_result3 *) in
(* socket_listen[4, // net.c:28] *)
if ¬((BIO_ctrl_result3)_[s,8] <= 0) then 
in(c, var11);
assume Defined(var11) in
(* assume_len[23, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var11) = 112 in
let BIO_pop_result1 = var11 (* named BIO_pop_result1 *) in
in(c, var12);
assume Defined(var12) in
(* assume_len[27, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var12) = 4 in
let BIO_free_result1 = var12 (* named BIO_free_result1 *) in
(* assume_intype[33, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(hostB) in
(* assume_intype[34, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(hostB) >= 0) /\ (len(hostB) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_host_proxy[29, // lib_proxy.c:225] *)
if ¬(len(hostB) > 40) then 
(* assume_intype[39, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(pkB) in
(* assume_intype[40, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(pkB) >= 0) /\ (len(pkB) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_pkey_proxy[35, // lib_proxy.c:143] *)
if ¬(len(pkB) > 100) then 
(* assume_intype[45, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(skB) in
(* assume_intype[46, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(skB) >= 0) /\ (len(skB) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_skey_proxy[41, // lib_proxy.c:167] *)
if ¬(len(skB) > 100) then 
in(c, var13);
assume Defined(var13) in
(* assume_len[50, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var13) = 8 in
let msg10 = var13 (* named msg10 *) in
(* main[1, // server.c:64] *)
if ¬((msg10)_[u,8] > 1000) then 
(* recv[54, // net.c:88] *)
if 0 < (msg10)_[u,8] then 
in(c, var14);
assume Defined(var14) in
(* assume_len[57, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var14) = (msg10)_[u,8] in
let msg11 = var14 (* named msg11 *) in
(* decrypt_len[59, // lib.c:53] *)
if ¬((msg10)_[u,8] < 7) then 
let cipher4 = msg11 (* named cipher4 *) in
let key7 = skB (* named key7 *) in
let msg12 = inverse_injbot(D(cipher4, key7)) (* named msg12 *) in
(* assume_intype[66, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(msg12) >= 0) /\ (len(msg12) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* decrypt_proxy[62, // lib_proxy.c:110] *)
if ¬(len(msg12) > ((msg10)_[u,8] - 7)) then 
(* main[1, // server.c:74] *)
if ¬((8 + 20 + 4) >= len(msg12)) then 
(* assume_intype[72, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume ((len(msg12) >= 4) /\ (0 >= 0) /\ (4 >= 0)) /\ True() in
(* assume_len[73, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(Cmp(msg12{0, 4}, "msg1")) = 4 in
(* main[1, // server.c:80] *)
if msg12{0, 4} = "msg1" then 
(* main[1, // server.c:88] *)
if ¬((msg12{4, 8})_[u,8] <> 20) then 
(* main[1, // server.c:97] *)
if ¬((len(msg12) - (4 + 8 + (msg12{4, 8})_[u,8])) > 40) then 
(* assume_intype[79, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(pkX) in
(* assume_intype[80, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(pkX) >= 0) /\ (len(pkX) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* get_xkey_proxy[75, // lib_proxy.c:189] *)
if ¬(len(pkX) > 100) then 
(* assume_intype[85, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(sigX) in
(* assume_intype[86, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(sigX) >= 0) /\ (len(sigX) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* assume_intype[91, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume Defined(pkS) in
(* assume_intype[92, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(pkS) >= 0) /\ (len(pkS) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
let host2 = msg12{4 + 8 + (msg12{4, 8})_[u,8], len(msg12) - (4 + 8 + (msg12{4, 8})_[u,8])} (* named host2 *) in
let key8 = pkX (* named key8 *) in
let sig2 = sigX (* named sig2 *) in
let sigkey2 = pkS (* named sigkey2 *) in
(* assume_len[98, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume 1 = 1 in
(* lookup_xkey[74, // keys.c:20] *)
if check_key(host2, key8, sig2, sigkey2) then 
event server_begin(msg12{4 + 8 + (msg12{4, 8})_[u,8], len(msg12) - (4 + 8 + (msg12{4, 8})_[u,8])}, hostB);
new var15: fixed_20_nonce;
let nonce4 = var15 (* named nonce4 *) in
let msg13 = "msg2"|msg12{4, 8}|(20)^[u,8]|msg12{4 + 8, (msg12{4, 8})_[u,8]}:fixed_20_nonce|nonce4|hostB (* named msg13 *) in
let key9 = pkX (* named key9 *) in
let key10 = isek(key9) (* named key10 *) in
new var16: fixed_256_seed_T;
let nonce5 = var16 (* named nonce5 *) in
let cipher5 = E(msg13, key10, nonce5) (* named cipher5 *) in
(* assume_intype[129, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(cipher5) >= 0) /\ (len(cipher5) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* encrypt_proxy[124, // lib_proxy.c:65] *)
if ¬(len(cipher5) > (7 + 40 + (2 * 8) + 4 + len(hostB))) then 
let msg14 = (len(cipher5))^[u,8] (* named msg14 *) in
out(c, msg14);
(* send[136, // net.c:66] *)
if 0 < len(cipher5) then 
let msg15 = cipher5 (* named msg15 *) in
out(c, msg15);
in(c, var17);
assume Defined(var17) in
(* assume_len[143, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var17) = 8 in
let msg16 = var17 (* named msg16 *) in
(* main[1, // server.c:179] *)
if ¬((msg16)_[u,8] > 1000) then 
(* recv[147, // net.c:88] *)
if 0 < (msg16)_[u,8] then 
in(c, var18);
assume Defined(var18) in
(* assume_len[150, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(var18) = (msg16)_[u,8] in
let msg17 = var18 (* named msg17 *) in
(* decrypt_len[152, // lib.c:53] *)
if ¬((msg16)_[u,8] < 7) then 
let cipher6 = msg17 (* named cipher6 *) in
let key11 = skB (* named key11 *) in
let msg18 = inverse_injbot(D(cipher6, key11)) (* named msg18 *) in
(* assume_intype[159, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume (len(msg18) >= 0) /\ (len(msg18) <= ((256 * 256 * 256 * 256 * 256 * 256 * 256 * 256) - 1)) in
(* decrypt_proxy[155, // lib_proxy.c:110] *)
if ¬(len(msg18) > ((msg16)_[u,8] - 7)) then 
(* assume_intype[165, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume ((len(msg18) >= 4) /\ (0 >= 0) /\ (4 >= 0)) /\ True() in
(* assume_len[166, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(Cmp(msg18{0, 4}, "msg3")) = 4 in
(* main[1, // server.c:189] *)
if msg18{0, 4} = "msg3" then 
(* main[1, // server.c:195] *)
if ¬(len(msg18) <> 24) then 
(* assume_intype[173, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:24] *)
assume ((len(msg18) >= len(msg18)) /\ (4 >= 0) /\ ((len(msg18) - 4) >= 0)) /\ Defined(nonce4) in
(* assume_len[174, // /home/avatar/docs/verification/svn/csec-modex/proxies/symbolic_interface.c:46] *)
assume len(Cmp(msg18{4, len(msg18) - 4}:fixed_20_nonce, nonce4)) = 4 in
(* main[1, // server.c:204] *)
ifeq msg18{4, len(msg18) - 4}:fixed_20_nonce = nonce4 then 
event server_end(msg12{4 + 8 + (msg12{4, 8})_[u,8], len(msg12) - (4 + 8 + (msg12{4, 8})_[u,8])}, hostB);

